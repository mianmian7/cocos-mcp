---
alwaysApply: true
description: Cocos Creator MCPæ‰©å±•é¡¹ç›®ç»“æ„å’Œæ¶æ„æŒ‡å—
---

# Cocos Creator MCP Server é¡¹ç›®ç»“æ„æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªCocos Creatorç¼–è¾‘å™¨æ‰©å±•é¡¹ç›®ï¼Œå®ç°äº†Model Context Protocol (MCP)æœåŠ¡å™¨ï¼Œç”¨äºAIè¾…åŠ©æ¸¸æˆå¼€å‘ã€‚

## ğŸ“ é¡¹ç›®æ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒç»„ä»¶ç»“æ„
```
cocos-mcp/
â”œâ”€â”€ source/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.ts               # æ‰©å±•å…¥å£ç‚¹
â”‚   â”œâ”€â”€ panels/               # UIé¢æ¿
â”‚   â”‚   â”œâ”€â”€ default/          # MCPæœåŠ¡å™¨æ§åˆ¶é¢æ¿
â”‚   â”‚   â”œâ”€â”€ ai-config/        # AIå›¾åƒç”Ÿæˆé…ç½®é¢æ¿
â”‚   â”‚   â””â”€â”€ image-generator/  # å›¾åƒç”Ÿæˆå™¨é¢æ¿
â”‚   â”œâ”€â”€ mcp/                  # MCPæœåŠ¡å™¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ server-manager.ts # æœåŠ¡å™¨ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ tools/            # MCPå·¥å…·å®ç°
â”‚   â”‚   â”œâ”€â”€ services/         # æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ config.ts         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ scene/                # åœºæ™¯è„šæœ¬
â”‚   â””â”€â”€ types/                # ç±»å‹å®šä¹‰
â”œâ”€â”€ dist/                     # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ static/                   # é™æ€èµ„æº
â””â”€â”€ i18n/                     # å›½é™…åŒ–æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Cocos Creator ç¼–è¾‘å™¨æ‰©å±•
- **è¯­è¨€**: TypeScript
- **UIæ¡†æ¶**: Vue 3.x (ç”¨äºé¢æ¿)
- **HTTPæœåŠ¡å™¨**: Express.js
- **åè®®**: Model Context Protocol (MCP)
- **éªŒè¯**: Zod schema éªŒè¯
- **æ„å»º**: TypeScript ç¼–è¯‘

## ğŸ¯ ä¸»è¦åŠŸèƒ½æ¨¡å—

### 1. MCPæœåŠ¡å™¨ç®¡ç† (`source/mcp/server-manager.ts`)
- HTTPæœåŠ¡å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- MCPä¼ è¾“å±‚å®ç° (Streamable HTTP + SSE)
- å·¥å…·æ³¨å†Œå’Œè°ƒåº¦
- é…ç½®ç®¡ç†å’ŒæŒä¹…åŒ–
- å›¾åƒç”ŸæˆæœåŠ¡é›†æˆ

### 2. MCPå·¥å…·é›† (`source/mcp/tools/`)
16ä¸ªç²¾å¿ƒè®¾è®¡çš„MCPå·¥å…·ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»ï¼š

**ğŸ” å‘ç°å’Œæ£€æŸ¥å·¥å…· (5ä¸ª)**
- `query_nodes` - åœºæ™¯å±‚æ¬¡ç»“æ„æ£€æŸ¥
- `query_components` - ç»„ä»¶å±æ€§å‘ç°
- `get_available_asset_types` - èµ„æºç±»å‹æšä¸¾
- `get_available_component_types` - ç»„ä»¶ç±»å‹æšä¸¾
- `get_assets_by_type` - æŒ‰ç±»å‹æŸ¥è¯¢èµ„æº

**ğŸ—ï¸ åˆ›å»ºå’Œä¿®æ”¹å·¥å…· (4ä¸ª)**
- `create_nodes` - æ‰¹é‡èŠ‚ç‚¹åˆ›å»º
- `modify_nodes` - èŠ‚ç‚¹å±æ€§æ›´æ–°å’Œå±‚æ¬¡ç»“æ„ä¿®æ”¹
- `modify_components` - ç»„ä»¶ç²¾ç¡®é…ç½®
- `generate_image_asset` - AIå›¾åƒèµ„æºç”Ÿæˆ

**ğŸ“¦ èµ„æºå’Œé¡¹ç›®ç®¡ç†å·¥å…· (5ä¸ª)**
- `operate_assets` - èµ„æºæ“ä½œ (åˆ›å»ºã€å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤)
- `operate_current_scene` - åœºæ™¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
- `operate_prefab_assets` - é¢„åˆ¶ä½“å·¥ä½œæµ
- `node_linked_prefabs_operations` - é¢„åˆ¶ä½“å®ä¾‹ç®¡ç†
- `operate_project_settings` - é¡¹ç›®é…ç½®ç®¡ç†

**ğŸ”§ é«˜çº§æ“ä½œå·¥å…· (2ä¸ª)**
- `execute_scene_code` - åœºæ™¯ä¸Šä¸‹æ–‡ä»£ç æ‰§è¡Œ
- `operate_scripts_and_text` - æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

### 3. UIé¢æ¿ç³»ç»Ÿ (`source/panels/`)
- **ä¸»æ§åˆ¶é¢æ¿** (`default/`) - MCPæœåŠ¡å™¨å¯åŠ¨/åœæ­¢æ§åˆ¶
- **AIé…ç½®é¢æ¿** (`ai-config/`) - AIå›¾åƒç”Ÿæˆæä¾›å•†é…ç½®
- **å›¾åƒç”Ÿæˆé¢æ¿** (`image-generator/`) - SVGè½¬å›¾åƒå¤„ç†ç•Œé¢

## ğŸš€ å¼€å‘å·¥ä½œæµç¨‹

### æ‰©å±•ç”Ÿå‘½å‘¨æœŸ
1. **åŠ è½½** (`load()`) - æ‰©å±•å¯åŠ¨æ—¶åˆå§‹åŒ–
2. **å¸è½½** (`unload()`) - æ¸…ç†èµ„æºå’Œåœæ­¢æœåŠ¡å™¨
3. **é¢æ¿äº¤äº’** - é€šè¿‡æ¶ˆæ¯ç³»ç»Ÿä¸Cocos Creatoré€šä¿¡

### MCPå·¥å…·å¼€å‘æµç¨‹
1. åœ¨ `source/mcp/tools/` åˆ›å»ºæ–°å·¥å…·æ–‡ä»¶
2. ä½¿ç”¨ `server.registerTool()` æ³¨å†Œå·¥å…·
3. å®ç°Zod schemaè¾“å…¥éªŒè¯
4. å¯¼å‡ºæ³¨å†Œå‡½æ•°
5. åœ¨ `server-manager.ts` ä¸­å¯¼å…¥å¹¶è°ƒç”¨

### æ„å»ºå’Œè°ƒè¯•
```bash
npm install        # å®‰è£…ä¾èµ–
npm run build      # ç¼–è¯‘TypeScript
```

## ğŸ” å…³é”®æ–‡ä»¶è¯´æ˜

### å…¥å£æ–‡ä»¶
- `source/main.ts` - æ‰©å±•ä¸»å…¥å£ï¼Œå®šä¹‰æ‰€æœ‰å¯ç”¨æ–¹æ³•
- `package.json` - æ‰©å±•é…ç½®ï¼Œå®šä¹‰é¢æ¿å’Œèœå•é¡¹

### MCPæ ¸å¿ƒæ–‡ä»¶
- `source/mcp/server-manager.ts` - æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- `source/mcp/config.ts` - é…ç½®å®šä¹‰å’Œé»˜è®¤å€¼
- `source/mcp/config-storage.ts` - é…ç½®æŒä¹…åŒ–å­˜å‚¨

### å·¥å…·å®ç°æ–‡ä»¶
- `source/mcp/tools/create-nodes.ts` - èŠ‚ç‚¹åˆ›å»ºå·¥å…·å®ç°ç¤ºä¾‹
- `source/mcp/tools/modify-nodes.ts` - èŠ‚ç‚¹ä¿®æ”¹å·¥å…·
- `source/mcp/tools/generate-image-asset.ts` - AIå›¾åƒç”Ÿæˆå·¥å…·

## ğŸ’¡ å¼€å‘æ³¨æ„äº‹é¡¹

1. **Cocos Creator API**: ä½¿ç”¨ `Editor.Message.request()` è°ƒç”¨ç¼–è¾‘å™¨API
2. **å¼‚æ­¥æ“ä½œ**: å¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œéœ€è¦ä½¿ç”¨ `await`
3. **UUIDç¼–ç **: ä½¿ç”¨ `McpServerManager.encodeUuid()` å’Œ `decodeUuid()` å¤„ç†UUID
4. **é”™è¯¯å¤„ç†**: å®ç°å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ
5. **ç±»å‹å®‰å…¨**: ä½¿ç”¨TypeScriptå’ŒZodç¡®ä¿ç±»å‹å®‰å…¨
6. **å›½é™…åŒ–**: ä½¿ç”¨ `i18n:` å‰ç¼€æ”¯æŒå¤šè¯­è¨€

## ğŸ”’ å®‰å…¨è€ƒè™‘

- æ–‡ä»¶ç³»ç»Ÿæ“ä½œå·¥å…· (`operate_scripts_and_text`) éœ€è¦è°¨æ…ä½¿ç”¨
- ä»£ç æ‰§è¡Œå·¥å…· (`execute_scene_code`) åªå…è®¸åœ¨åœºæ™¯ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ
- æ‰€æœ‰è¾“å…¥éƒ½éœ€è¦é€šè¿‡Zod schemaéªŒè¯
- é…ç½®ä¿¡æ¯æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨

è¿™ä¸ªé¡¹ç›®ä¸ºAIè¾…åŠ©æ¸¸æˆå¼€å‘æä¾›äº†å¼ºå¤§çš„åŸºç¡€è®¾æ–½ï¼Œé€šè¿‡MCPåè®®è®©AIåŠ©æ‰‹èƒ½å¤Ÿç›´æ¥ä¸Cocos Creatorç¼–è¾‘å™¨äº¤äº’ã€‚